<!-- Page Heading -->
<h1 class="text-5xl font-bold mb-8 text-gray-900">Posts</h1>

<!-- Sorting Controls -->
<div class="relative mb-4">
  <%= turbo_frame_tag "sort_button" do %>
    <button id="sortButton" class="flex items-center text-grey bg-grey focus:outline-none font-medium rounded-lg text-sm px-4 py-2.5 text-center inline-flex items-center" type="button">
      <span><%= @current_sort_label || 'Sort Options' %></span>
      <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </button>
  <% end %>

  <!-- Dropdown Menu -->
  <div id="sortDropdown" class="z-10 hidden absolute bg-white divide-y divide-gray-100 rounded-lg shadow w-44">
    <ul class="py-2 text-sm text-gray-700" aria-labelledby="sortButton">
      <li>
        <%= link_to 'Title (Asc)',
          posts_path(sort: 'title_asc', page: params[:page]),
          data: { turbo_frame: 'posts' },
          class: "block px-4 py-2 hover:bg-gray-100" %>
      </li>
      <li>
        <%= link_to 'Title (Desc)',
          posts_path(sort: 'title_desc', page: params[:page]),
          data: { turbo_frame: 'posts' },
          class: "block px-4 py-2 hover:bg-gray-100"
        %>
      </li>
      <li>
        <%= link_to 'Date (Asc)',
          posts_path(sort: 'created_at_asc', page: params[:page]),
          data: { turbo_frame: 'posts' },
          class: "block px-4 py-2 hover:bg-gray-100"
        %>
      </li>
      <li>
        <%= link_to 'Date (Desc)',
          posts_path(sort: 'created_at_desc', page: params[:page]),
          data: { turbo_frame: 'posts' },
          class: "block px-4 py-2 hover:bg-gray-100"
        %>
      </li>
    </ul>
  </div>
</div>

<!-- Posts List -->
<div id="posts" class="space-y-6">
  <% @posts.each do |post| %>
    <div id="<%= dom_id(post) %>" class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
      <div class="flex items-center mb-4">
        <div class="flex-shrink-0 w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center text-gray-600 font-bold">
          <%= post.title[0] %>
        </div>
        <div class="ml-4">
          <h2 class="text-xl font-semibold text-gray-800"><%= post.title %></h2>
          <p class="text-gray-600 text-sm"><%= time_ago_in_words(post.created_at) %> ago</p>
        </div>
      </div>

      <div class="mt-2">
        <%= render post %>
      </div>

      <div class="mt-4 flex justify-between items-center">
        <%= link_to "Show this post", post, class: "text-blue-600 hover:underline" %>
        <%= link_to 'Delete Post',
          post_path(post),
          data: {
            turbo_method: :delete,
            turbo_confirm: 'Are you sure you want to delete this post?'
          },
          class: "text-red-600 hover:underline"
        %>
      </div>
    </div>
  <% end %>
</div>


<!-- Pagination Links -->
<%= paginate @posts, remote: true %>

